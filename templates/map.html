<!DOCTYPE html>
<html>
<head>
    <title>Location Picker</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
</head>
<body>
    <div id="mapid" style="width: 600px; height: 400px;"></div>
    <script>

var mymap = L.map('mapid').setView([52.231, 21.004], 7); //  default location and zoom level

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 19,
    attribution: 'Â© OpenStreetMap contributors'
}).addTo(mymap);

var marker;

mymap.on('click', function(e) {
    var coord = e.latlng;
    var lat = coord.lat;
    var lng = coord.lng;

    // Clear existing marker,
    if (marker) {
        mymap.removeLayer(marker);
    }

    // Add a marker to show where you clicked.
    marker = L.marker([lat, lng]).addTo(mymap);

    // (Optional) Send the coordinates to your Flask backend
    sendLocation(lat, lng);
    
});       

function sendLocation(lat, lng) {
    fetch('/submit_location', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({lat: lat, lng: lng})
    })
    .then(response => response.text())
    .then(data => {
        console.log('Success:', data);
    })
    .catch((error) => {
        console.error('Error:', error);
    });
}

    </script>
</body>
</html>
